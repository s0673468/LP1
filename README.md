# Обучение с учителем

Задача работы — помочь удержать уровень покупательской активности существующих клиентов с помощью персонализированных предложений, направленных на пользователей с высокой вероятностью её снижения 
В качестве исходных данных нам предоставлено четыре таблицы с данными с продуктовым и финансовым поведением, поведением на сайте, маркетинговыми коммуникациям и целевой признак — покупательская активность(«снизилась», если клиент стал покупать меньше товаров, и «прежний уровень»). 
Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента и промаркировать уровень покупательской активности клиентов.
После определения модели нужно обогатить сводную таблицу дополнительными данными финансового департамента о прибыльности клиента. Используя данные модели и данные о прибыльности клиентов, нужно выделить сегмент покупателей и разработать для них персонализированные предложения.

Общий вывод

Наша задача была помочь удержать уровень покупательской активности существующих клиентов с помощью персонализированных предложений, направленных на пользователей с высокой вероятностью её снижения.
В качестве исходных данных нам было предоставлено четыре таблицы с данными о продуктовом и финансовым поведении, поведении на сайте и маркетинговым коммуникациям. Данные не содержали пропусков, но было необходимо удалить небольшое количество дубликатов, у которых, при этом, оказались разные номера id. В таблицах была информация по выручке за три месяца и время, проведенное на сайте за два месяца.
Качество данных — высокое, исследовательский анализ данных не обнаружил каких-либо очевидно ошибочных значений и распределение между мажорным и минорным классом целевого признака было достаточно равномерным, чтобы при построении модели мы могли использовать обычную стратификацию тестовой выборки.
Поиск модели был произведен при помощи рандомизированного подбора гиперпараметров масштабирования количественных признаков и четырех типов моделей. Учитывая, что в описании задач не был отдан приоритет ошибкам первого или второго типа и распределение по классам целевого признака достаточно равномерно, для оценки мы использовали метрику ROC_AUC.
В результате мы получили три типа моделей с достаточно похожим результатом при кросс-валидации. Выбрана для дальнейшего использования была логистическая регрессия как показавшая более высокий результат на тестовой выборке и более простая в использовании. Используемая в модели l1 регуляризация с низким C фактически произвела отбор наиболее значимых признаков.
Был проведен дополнительный анализ в сегменте покупателей с высокой прибылью и высокой вероятностью снижения покупательской активности. В результате для проведения таргетных акций предложено предоставление скидок на товары в категориях 'мелкая бытовая техника' и 'техника для красоты и здоровья' или для популярной категории среди добавленных в корзину, но не оплаченных товаров, при условии достижения порогового значения по общей сумме покупки.
